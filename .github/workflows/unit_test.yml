## run swift build and test for the Package.swift
## return success or failure

name: Swift Package CI

on:
  workflow_call:
    inputs:
      input2:
        description: 'No input required'
        required: false
    secrets: inherit

outputs:
  test_success:
    description: 'Indicates if unit tests passed or failed'
    value: ${{ jobs.run_tests.outputs.test_success }}

jobs:
  run_tests:
    runs-on: ubuntu-latest
    outputs:
      test_success: ${{ steps.set_test_success_output.outputs.test_success }}
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Run Unit Tests
        id: test
        run: |
          swift test
        continue-on-error: true
      
      - name: Set Test Success Output
        id: set_test_success_output
        run: echo "test_success=${{ steps.test.outcome }}" >> $GITHUB_OUTPUT